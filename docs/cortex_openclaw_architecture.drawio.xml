<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="draw.io">
  <diagram name="Cortex × OpenClaw Architecture" id="cortex-openclaw-arch">
    <mxGraphModel dx="1600" dy="1000" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Title -->
        <mxCell id="title" value="Cortex × OpenClaw — Hybrid Memory Architecture" style="text;html=1;fontSize=22;fontStyle=1;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#1a1a2e;" vertex="1" parent="1">
          <mxGeometry x="400" y="15" width="800" height="40" as="geometry"/>
        </mxCell>

        <!-- OPENCLAW CONTAINER -->
        <mxCell id="oc-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=2;arcSize=4;dashed=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="70" width="1010" height="680" as="geometry"/>
        </mxCell>
        <mxCell id="oc-label" value="OpenClaw" style="text;html=1;fontSize=18;fontStyle=1;align=left;verticalAlign=top;fillColor=none;strokeColor=none;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="55" y="78" width="200" height="30" as="geometry"/>
        </mxCell>

        <!-- NATIVE MEMORY (left column) -->
        <mxCell id="native-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8eaf6;strokeColor=#5c6bc0;strokeWidth=1.5;arcSize=6;" vertex="1" parent="1">
          <mxGeometry x="60" y="115" width="280" height="380" as="geometry"/>
        </mxCell>
        <mxCell id="native-label" value="Native Memory (unchanged)" style="text;html=1;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#3949ab;" vertex="1" parent="1">
          <mxGeometry x="60" y="120" width="280" height="25" as="geometry"/>
        </mxCell>

        <mxCell id="soul" value="SOUL.md&#xa;Agent constitution" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c5cae9;strokeColor=#5c6bc0;fontSize=11;align=center;" vertex="1" parent="1">
          <mxGeometry x="80" y="155" width="120" height="45" as="geometry"/>
        </mxCell>
        <mxCell id="user-md" value="USER.md&#xa;Operator prefs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c5cae9;strokeColor=#5c6bc0;fontSize=11;align=center;" vertex="1" parent="1">
          <mxGeometry x="210" y="155" width="120" height="45" as="geometry"/>
        </mxCell>
        <mxCell id="memory-md" value="MEMORY.md&#xa;Curated strategic facts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#9fa8da;strokeColor=#5c6bc0;fontSize=11;align=center;fontColor=#1a237e;" vertex="1" parent="1">
          <mxGeometry x="80" y="215" width="250" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="daily-logs" value="memory/*.md&#xa;Daily logs (48hr auto-load)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c5cae9;strokeColor=#5c6bc0;fontSize=11;align=center;" vertex="1" parent="1">
          <mxGeometry x="80" y="270" width="250" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="sessions" value="sessions/*.jsonl&#xa;Raw transcripts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#c5cae9;strokeColor=#5c6bc0;fontSize=11;align=center;" vertex="1" parent="1">
          <mxGeometry x="80" y="325" width="250" height="40" as="geometry"/>
        </mxCell>
        <mxCell id="sqlite" value="SQLite&#xa;FTS5 + sqlite-vec index" style="shape=cylinder3;whiteSpace=wrap;html=1;fillColor=#c5cae9;strokeColor=#5c6bc0;fontSize=11;size=10;align=center;" vertex="1" parent="1">
          <mxGeometry x="130" y="385" width="150" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="native-search" value="memory_search&#xa;(local, fast)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8eaf6;strokeColor=#7986cb;fontSize=10;fontStyle=2;align=center;" vertex="1" parent="1">
          <mxGeometry x="80" y="450" width="250" height="30" as="geometry"/>
        </mxCell>

        <!-- NPM PLUGIN (Phase 2, center-right) -->
        <mxCell id="plugin-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#43a047;strokeWidth=1.5;arcSize=6;" vertex="1" parent="1">
          <mxGeometry x="365" y="115" width="310" height="380" as="geometry"/>
        </mxCell>
        <mxCell id="plugin-label" value="@cortex/openclaw-plugin (Phase 2)" style="text;html=1;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#2e7d32;" vertex="1" parent="1">
          <mxGeometry x="365" y="120" width="310" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="plugin-phase" value="npm plugin — lifecycle hooks" style="text;html=1;fontSize=10;fontStyle=2;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#558b2f;" vertex="1" parent="1">
          <mxGeometry x="365" y="142" width="310" height="18" as="geometry"/>
        </mxCell>

        <!-- Auto-Recall -->
        <mxCell id="auto-recall" value="Auto-Recall" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a5d6a7;strokeColor=#43a047;fontSize=12;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="385" y="170" width="270" height="35" as="geometry"/>
        </mxCell>
        <mxCell id="auto-recall-detail" value="before_agent_start → POST /v1/retrieve (mode=fast)&#xa;Injects &lt;cortex_memories&gt; via prependContext&#xa;Hard timeout: 500ms (configurable)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=none;fontSize=9;align=left;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="385" y="205" width="270" height="48" as="geometry"/>
        </mxCell>

        <!-- Auto-Capture -->
        <mxCell id="auto-capture" value="Auto-Capture" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a5d6a7;strokeColor=#43a047;fontSize=12;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="385" y="268" width="270" height="35" as="geometry"/>
        </mxCell>
        <mxCell id="auto-capture-detail" value="post-response → POST /v1/ingest (selective)&#xa;Heuristic filter: length, assertions, corrections" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=none;fontSize=9;align=left;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="385" y="303" width="270" height="35" as="geometry"/>
        </mxCell>

        <!-- File Sync -->
        <mxCell id="file-sync" value="File Sync (FileSync class)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a5d6a7;strokeColor=#43a047;fontSize=12;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="385" y="353" width="270" height="35" as="geometry"/>
        </mxCell>
        <mxCell id="file-sync-detail" value="MEMORY.md → diff-based (2s debounce)&#xa;memory/*.md → append-based (offset tracking)&#xa;sessions/*.jsonl → clean + batch ingest (Phase 3)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#c8e6c9;strokeColor=none;fontSize=9;align=left;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="385" y="388" width="270" height="48" as="geometry"/>
        </mxCell>

        <!-- Dedup tag -->
        <mxCell id="dedup" value="Dedup: sets &lt;cortex_memories&gt; tag&#xa;so SKILL.md skips redundant recall" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#81c784;fontSize=9;fontStyle=2;align=center;" vertex="1" parent="1">
          <mxGeometry x="385" y="450" width="270" height="30" as="geometry"/>
        </mxCell>

        <!-- SKILL.MD (Phase 1, right column) -->
        <mxCell id="skill-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#ef6c00;strokeWidth=1.5;arcSize=6;" vertex="1" parent="1">
          <mxGeometry x="700" y="115" width="330" height="380" as="geometry"/>
        </mxCell>
        <mxCell id="skill-label" value="cortex-memory SKILL.md (Phase 1)" style="text;html=1;fontSize=13;fontStyle=1;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#e65100;" vertex="1" parent="1">
          <mxGeometry x="700" y="120" width="330" height="25" as="geometry"/>
        </mxCell>
        <mxCell id="skill-phase" value="Markdown skill — agent-initiated, zero dependency" style="text;html=1;fontSize=10;fontStyle=2;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#bf360c;" vertex="1" parent="1">
          <mxGeometry x="700" y="142" width="330" height="18" as="geometry"/>
        </mxCell>

        <mxCell id="skill-recall" value="Recall" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#ef6c00;fontSize=12;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="720" y="170" width="290" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="skill-recall-d" value="Agent decides → curl POST /v1/retrieve&#xa;Supports mode=full and mode=fast" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff8e1;strokeColor=none;fontSize=9;align=left;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="720" y="200" width="290" height="32" as="geometry"/>
        </mxCell>

        <mxCell id="skill-remember" value="Remember" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#ef6c00;fontSize=12;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="720" y="247" width="290" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="skill-remember-d" value="User says &quot;remember this&quot; → curl POST /v1/ingest&#xa;Structured fact + entity extraction" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff8e1;strokeColor=none;fontSize=9;align=left;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="720" y="277" width="290" height="32" as="geometry"/>
        </mxCell>

        <mxCell id="skill-convo" value="Ingest Conversation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#ef6c00;fontSize=12;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="720" y="324" width="290" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="skill-convo-d" value="End of session → curl POST /v1/ingest/conversation&#xa;Speaker attribution, 5-15 key messages" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff8e1;strokeColor=none;fontSize=9;align=left;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="720" y="354" width="290" height="32" as="geometry"/>
        </mxCell>

        <mxCell id="skill-bootstrap" value="Bootstrap" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#ef6c00;fontSize=12;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="720" y="401" width="290" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="skill-bootstrap-d" value="First run → ingest existing MEMORY.md&#xa;Chunked at ## headings for large files" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff8e1;strokeColor=none;fontSize=9;align=left;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="720" y="431" width="290" height="32" as="geometry"/>
        </mxCell>

        <mxCell id="skill-warning" value="Agent must decide to call Cortex&#xa;(unreliable for routine queries)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#ffb74d;fontSize=9;fontStyle=2;align=center;fontColor=#bf360c;" vertex="1" parent="1">
          <mxGeometry x="720" y="472" width="290" height="28" as="geometry"/>
        </mxCell>

        <!-- AGENT BAR -->
        <mxCell id="agent-bar" value="OpenClaw Agent (Claude)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#37474f;strokeColor=#263238;fontSize=14;fontStyle=1;fontColor=#ffffff;align=center;" vertex="1" parent="1">
          <mxGeometry x="60" y="520" width="970" height="45" as="geometry"/>
        </mxCell>
        <mxCell id="agent-detail" value="System prompt includes: SOUL.md + USER.md + MEMORY.md + SKILL.md instructions + &lt;cortex_memories&gt; (if plugin active)" style="text;html=1;fontSize=9;fontStyle=2;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#90a4ae;" vertex="1" parent="1">
          <mxGeometry x="60" y="565" width="970" height="18" as="geometry"/>
        </mxCell>

        <!-- USER -->
        <mxCell id="user" value="User" style="shape=actor;whiteSpace=wrap;html=1;fillColor=#eceff1;strokeColor=#546e7a;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="510" y="600" width="50" height="55" as="geometry"/>
        </mxCell>

        <!-- User to Agent -->
        <mxCell id="user-to-agent" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;originSize=0.5;terminateSize=0.5;strokeColor=#546e7a;strokeWidth=1.5;exitX=0.5;exitY=0;entryX=0.5;entryY=1;" edge="1" source="user" target="agent-bar" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- FILE SYNC ARROWS (native files to plugin) -->
        <mxCell id="fs-memory" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#43a047;strokeWidth=1;dashed=1;dashPattern=4 3;entryX=0;entryY=0.5;exitX=1;exitY=0.5;" edge="1" source="memory-md" target="file-sync" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="fs-daily" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#43a047;strokeWidth=1;dashed=1;dashPattern=4 3;exitX=1;exitY=0.5;" edge="1" source="daily-logs" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="385" y="370" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="fs-sessions" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#43a047;strokeWidth=1;dashed=1;dashPattern=4 3;exitX=1;exitY=0.5;" edge="1" source="sessions" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="385" y="390" as="targetPoint"/>
          </mxGeometry>
        </mxCell>

        <!-- HTTPS BOUNDARY -->
        <mxCell id="https-line" value="" style="shape=line;strokeColor=#d32f2f;strokeWidth=2;dashed=1;dashPattern=8 4;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="40" y="770" width="1520" height="10" as="geometry"/>
        </mxCell>
        <mxCell id="https-label" value="HTTPS" style="text;html=1;fontSize=11;fontStyle=1;align=center;verticalAlign=middle;fillColor=#ffebee;strokeColor=#e53935;rounded=1;fontColor=#c62828;labelBackgroundColor=none;" vertex="1" parent="1">
          <mxGeometry x="750" y="760" width="60" height="22" as="geometry"/>
        </mxCell>

        <!-- CORTEX API (AWS) -->
        <mxCell id="aws-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#1565c0;strokeWidth=2;arcSize=4;" vertex="1" parent="1">
          <mxGeometry x="240" y="800" width="1080" height="240" as="geometry"/>
        </mxCell>
        <mxCell id="aws-label" value="Cortex API (AWS)" style="text;html=1;fontSize=18;fontStyle=1;align=left;verticalAlign=top;fillColor=none;strokeColor=none;fontColor=#0d47a1;" vertex="1" parent="1">
          <mxGeometry x="258" y="808" width="300" height="30" as="geometry"/>
        </mxCell>

        <!-- API Gateway -->
        <mxCell id="apigw" value="API Gateway" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1565c0;fontSize=12;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="280" y="860" width="130" height="50" as="geometry"/>
        </mxCell>

        <!-- Lambda Auth -->
        <mxCell id="lambda" value="Lambda&#xa;(auth)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1565c0;fontSize=11;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="450" y="860" width="100" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="lambda-detail" value="API key → tenant_id&#xa;Sets X-Tenant-Id header" style="text;html=1;fontSize=9;fontStyle=2;align=center;fillColor=none;strokeColor=none;fontColor=#1565c0;" vertex="1" parent="1">
          <mxGeometry x="425" y="912" width="150" height="28" as="geometry"/>
        </mxCell>

        <!-- ALB -->
        <mxCell id="alb" value="ALB" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#bbdefb;strokeColor=#1565c0;fontSize=12;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="590" y="860" width="80" height="50" as="geometry"/>
        </mxCell>

        <!-- ECS Fargate -->
        <mxCell id="ecs" value="ECS Fargate&#xa;FastAPI + Cortex" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#90caf9;strokeColor=#1565c0;fontSize=12;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="720" y="850" width="180" height="65" as="geometry"/>
        </mxCell>
        <mxCell id="ecs-detail" value="5-way hybrid retrieval pipeline&#xa;ENGRAVE extraction + graph store&#xa;mode=fast: BM25 + semantic + RRF only" style="text;html=1;fontSize=9;fontStyle=2;align=center;fillColor=none;strokeColor=none;fontColor=#1565c0;" vertex="1" parent="1">
          <mxGeometry x="700" y="918" width="220" height="40" as="geometry"/>
        </mxCell>

        <!-- RDS -->
        <mxCell id="rds" value="RDS&#xa;Postgres + pgvector" style="shape=cylinder3;whiteSpace=wrap;html=1;fillColor=#64b5f6;strokeColor=#1565c0;fontSize=12;fontStyle=1;size=12;align=center;fontColor=#0d47a1;" vertex="1" parent="1">
          <mxGeometry x="970" y="848" width="160" height="70" as="geometry"/>
        </mxCell>
        <mxCell id="rds-detail" value="Tenant-isolated databases&#xa;Knowledge graph + embeddings" style="text;html=1;fontSize=9;fontStyle=2;align=center;fillColor=none;strokeColor=none;fontColor=#1565c0;" vertex="1" parent="1">
          <mxGeometry x="960" y="922" width="180" height="28" as="geometry"/>
        </mxCell>

        <!-- AWS internal arrows -->
        <mxCell id="gw-to-lambda" style="rounded=1;strokeColor=#1565c0;strokeWidth=1.5;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" edge="1" source="apigw" target="lambda" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="lambda-to-alb" style="rounded=1;strokeColor=#1565c0;strokeWidth=1.5;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" edge="1" source="lambda" target="alb" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="alb-to-ecs" style="rounded=1;strokeColor=#1565c0;strokeWidth=1.5;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" edge="1" source="alb" target="ecs" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="ecs-to-rds" style="rounded=1;strokeColor=#1565c0;strokeWidth=1.5;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" edge="1" source="ecs" target="rds" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- MAIN DATA FLOW ARROWS (Plugin + Skill to API) -->

        <!-- Plugin Auto-Recall arrow -->
        <mxCell id="plugin-to-api" value="Auto-Recall&#xa;mode=fast" style="rounded=1;strokeColor=#2e7d32;strokeWidth=2;exitX=0.5;exitY=1;entryX=0.35;entryY=0;fontColor=#2e7d32;fontSize=10;fontStyle=1;labelBackgroundColor=#ffffff;" edge="1" source="plugin-container" target="apigw" parent="1">
          <mxGeometry x="0.3" relative="1" as="geometry">
            <mxPoint as="offset"/>
            <Array as="points">
              <mxPoint x="520" y="720"/>
              <mxPoint x="520" y="750"/>
              <mxPoint x="326" y="750"/>
              <mxPoint x="326" y="860"/>
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Plugin Auto-Capture + File Sync arrow -->
        <mxCell id="plugin-ingest" value="Auto-Capture&#xa;+ File Sync" style="rounded=1;strokeColor=#43a047;strokeWidth=1.5;dashed=1;dashPattern=6 3;exitX=0.3;exitY=1;fontColor=#43a047;fontSize=9;fontStyle=2;labelBackgroundColor=#ffffff;" edge="1" source="plugin-container" parent="1">
          <mxGeometry x="0.4" relative="1" as="geometry">
            <mxPoint as="offset"/>
            <mxPoint x="300" y="860" as="targetPoint"/>
            <Array as="points">
              <mxPoint x="458" y="720"/>
              <mxPoint x="458" y="750"/>
              <mxPoint x="300" y="750"/>
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Skill arrows -->
        <mxCell id="skill-to-api" value="Agent curl&#xa;(on-demand)" style="rounded=1;strokeColor=#e65100;strokeWidth=2;exitX=0.5;exitY=1;entryX=0.65;entryY=0;fontColor=#e65100;fontSize=10;fontStyle=1;labelBackgroundColor=#ffffff;" edge="1" source="skill-container" target="apigw" parent="1">
          <mxGeometry x="0.3" relative="1" as="geometry">
            <mxPoint as="offset"/>
            <Array as="points">
              <mxPoint x="865" y="720"/>
              <mxPoint x="865" y="750"/>
              <mxPoint x="365" y="750"/>
              <mxPoint x="365" y="860"/>
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- LATENCY ANNOTATIONS -->
        <mxCell id="latency-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#e53935;strokeWidth=1;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="1090" y="70" width="470" height="300" as="geometry"/>
        </mxCell>
        <mxCell id="latency-title" value="Latency Budget" style="text;html=1;fontSize=14;fontStyle=1;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#c62828;" vertex="1" parent="1">
          <mxGeometry x="1090" y="75" width="470" height="25" as="geometry"/>
        </mxCell>

        <mxCell id="lat-fast" value="mode=fast (Auto-Recall path)" style="text;html=1;fontSize=11;fontStyle=1;align=left;fillColor=none;strokeColor=none;fontColor=#c62828;" vertex="1" parent="1">
          <mxGeometry x="1110" y="105" width="250" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="lat-fast-detail" value="Server-side: ~80-150ms (BM25 + semantic + RRF)&#xa;End-to-end (us-east-1): ~200-300ms&#xa;End-to-end (EU/APAC): ~400-600ms&#xa;Plugin hard timeout: 500ms (configurable)" style="text;html=1;fontSize=10;align=left;fillColor=none;strokeColor=none;fontColor=#b71c1c;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="1110" y="125" width="430" height="60" as="geometry"/>
        </mxCell>

        <mxCell id="lat-full" value="mode=full (Skill / direct API)" style="text;html=1;fontSize=11;fontStyle=1;align=left;fillColor=none;strokeColor=none;fontColor=#c62828;" vertex="1" parent="1">
          <mxGeometry x="1110" y="195" width="250" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="lat-full-detail" value="Server-side: ~300-600ms (all 5 channels + graph&#xa;+ reranker + session expansion + packing)&#xa;Best recall quality, higher latency" style="text;html=1;fontSize=10;align=left;fillColor=none;strokeColor=none;fontColor=#b71c1c;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="1110" y="215" width="430" height="48" as="geometry"/>
        </mxCell>

        <mxCell id="lat-timeout" value="Timeout policy: silent degradation" style="text;html=1;fontSize=11;fontStyle=1;align=left;fillColor=none;strokeColor=none;fontColor=#c62828;" vertex="1" parent="1">
          <mxGeometry x="1110" y="275" width="300" height="20" as="geometry"/>
        </mxCell>
        <mxCell id="lat-timeout-d" value="If exceeded → agent proceeds without memories&#xa;Never blocks the user. Missing memory &gt; slow response." style="text;html=1;fontSize=10;align=left;fillColor=none;strokeColor=none;fontColor=#b71c1c;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="1110" y="295" width="430" height="35" as="geometry"/>
        </mxCell>

        <!-- PHASE TIMELINE -->
        <mxCell id="phase-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#7b1fa2;strokeWidth=1;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="1090" y="390" width="470" height="270" as="geometry"/>
        </mxCell>
        <mxCell id="phase-title" value="Implementation Phases" style="text;html=1;fontSize=14;fontStyle=1;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#6a1b9a;" vertex="1" parent="1">
          <mxGeometry x="1090" y="395" width="470" height="25" as="geometry"/>
        </mxCell>

        <mxCell id="p1" value="Phase 1: SKILL.md" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe0b2;strokeColor=#ef6c00;fontSize=11;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="1110" y="430" width="430" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="p1d" value="ClawHub publish. Agent-initiated recall/remember. Validates retrieval quality." style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;fontColor=#4a148c;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="1110" y="460" width="430" height="18" as="geometry"/>
        </mxCell>

        <mxCell id="p2" value="Phase 2: npm Plugin (the real launch)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#a5d6a7;strokeColor=#43a047;fontSize=11;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="1110" y="488" width="430" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="p2d" value="Auto-Recall + Auto-Capture + File Sync. Parity with Mem0/Cognee/Supermemory." style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;fontColor=#4a148c;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="1110" y="518" width="430" height="18" as="geometry"/>
        </mxCell>

        <mxCell id="p3" value="Phase 3: Advanced Features" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1bee7;strokeColor=#7b1fa2;fontSize=11;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="1110" y="546" width="430" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="p3d" value="Transcript ingestion, cortex_relate, reflection triggers, auto-recall tuning." style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;fontColor=#4a148c;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="1110" y="576" width="430" height="18" as="geometry"/>
        </mxCell>

        <mxCell id="p4" value="Phase 4: MCP Server (non-OpenClaw clients)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1bee7;strokeColor=#7b1fa2;fontSize=11;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="1110" y="604" width="430" height="30" as="geometry"/>
        </mxCell>
        <mxCell id="p4d" value="Claude Desktop, Claude Code, VS Code Copilot, Cursor. Tool-based (no auto-recall)." style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;fontColor=#4a148c;spacingLeft=8;" vertex="1" parent="1">
          <mxGeometry x="1110" y="634" width="430" height="18" as="geometry"/>
        </mxCell>

        <!-- LEGEND -->
        <mxCell id="legend-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fafafa;strokeColor=#bdbdbd;strokeWidth=1;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="1090" y="680" width="470" height="90" as="geometry"/>
        </mxCell>
        <mxCell id="legend-title" value="Legend" style="text;html=1;fontSize=11;fontStyle=1;align=left;fillColor=none;strokeColor=none;fontColor=#424242;" vertex="1" parent="1">
          <mxGeometry x="1100" y="685" width="60" height="18" as="geometry"/>
        </mxCell>

        <mxCell id="leg1" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8eaf6;strokeColor=#5c6bc0;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="1110" y="708" width="16" height="16" as="geometry"/>
        </mxCell>
        <mxCell id="leg1t" value="OpenClaw native (unchanged)" style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="1130" y="708" width="160" height="16" as="geometry"/>
        </mxCell>

        <mxCell id="leg2" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#43a047;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="1110" y="730" width="16" height="16" as="geometry"/>
        </mxCell>
        <mxCell id="leg2t" value="npm plugin (automatic, Phase 2)" style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="1130" y="730" width="170" height="16" as="geometry"/>
        </mxCell>

        <mxCell id="leg3" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#ef6c00;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="1110" y="752" width="16" height="16" as="geometry"/>
        </mxCell>
        <mxCell id="leg3t" value="SKILL.md (agent-initiated, Phase 1)" style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="1130" y="752" width="180" height="16" as="geometry"/>
        </mxCell>

        <mxCell id="leg4" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e3f2fd;strokeColor=#1565c0;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="1330" y="708" width="16" height="16" as="geometry"/>
        </mxCell>
        <mxCell id="leg4t" value="Cortex API (AWS)" style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="1350" y="708" width="120" height="16" as="geometry"/>
        </mxCell>

        <mxCell id="leg5" value="" style="endArrow=classic;strokeColor=#2e7d32;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1330" y="738" as="sourcePoint"/>
            <mxPoint x="1360" y="738" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="leg5t" value="Automatic data flow" style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="1365" y="730" width="120" height="16" as="geometry"/>
        </mxCell>

        <mxCell id="leg6" value="" style="endArrow=classic;strokeColor=#43a047;strokeWidth=1;dashed=1;dashPattern=4 3;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1330" y="760" as="sourcePoint"/>
            <mxPoint x="1360" y="760" as="targetPoint"/>
          </mxGeometry>
        </mxCell>
        <mxCell id="leg6t" value="File watch / background sync" style="text;html=1;fontSize=9;align=left;fillColor=none;strokeColor=none;" vertex="1" parent="1">
          <mxGeometry x="1365" y="752" width="160" height="16" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
